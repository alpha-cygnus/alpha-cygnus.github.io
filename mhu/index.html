<html>
<head>
<meta charset="utf-8"> 
<title>MHU-1</title>
<script src="../lib/jquery-2.1.1.js"></script>
<script src="../lib/Tone.js"></script>
<script src="../lib/oo.js"></script>
<script src="../lib/aa.js"></script>
<script>
var theRack = AA.newObj(['Rack',
	['Osc', {t: 'sawtooth'}],
	['Osc', {t: 'sawtooth'}],
	['Osc', {t: 'square'}],
	['Amp'],
	['Amp'],
	['Env', {a:0.3, d:0.5, s:0.4, r:0.8}],
	['Env', {a:0, d:0.5, s:0.8, r:0.2}],
	['Mono'],
	['Const'],
	['Keyboard', {p: 0.05}],
	{
		'O1>A1': 0.5,
		'O2>A1': 0.5,
		'O3>A2': 0.5,
		'A1>M1': 0.5,
		'A2>M1': 0.5,
		'E1>A1.g':1,
		'E2>A2.g':1,
		'K1>O1.n':1,
		'K1>O2.n':1,
		'K1>O3.n':1,
		'C1>O1.n':-0.01,
		'C1>O2.n':+0.01,
		'C1>O3.n':-2,
		'g:K1>E1':1,
		'g:K1>E2':1,
	}
]);
var keysDown = {};
var keysToNotes = {
	81: 60,
	50: 61,
	87: 62,
	51: 63,
	69: 64,
	82: 65,
	53: 66,
	84: 67,
	54: 68,
	89: 69,
	55: 71,
	85: 72,
	73: 73,
	57: 74,
	79: 75,
	48: 76,
	80: 77,
	
	90: 48,
	83: 49,
	88: 50,
	68: 51,
	67: 52,
	86: 53,
	71: 54,
	66: 55,
	72: 56,
	78: 57,
	74: 58,
	77: 59,
	188: 60,
	76: 61,
	190: 62,
	186: 63,
	191: 64,
};
$(window).on('keydown', function(e) {
	//console.log('keydown', e);
	if (keysDown[e.keyCode]) return;
	console.log('down', e.keyCode);
	keysDown[e.keyCode] = 1;
	var n = keysToNotes[e.keyCode];
	if (n) {
		for (k in AA.keyboards) {
			AA.keyboards[k].trig(e.shiftKey ? undefined : 1, n);
		}
	}
});
$(window).on('keyup', function(e) {
	//console.log('up', e.keyCode);
	keysDown[e.keyCode] = 0;
	var n = keysToNotes[e.keyCode];
	if (n) {
		for (k in AA.keyboards) {
			AA.keyboards[k].trig(e.shiftKey ? undefined : 0, n);
		}
	}
});
</script>
</head>
<body>
</body>
</html>	